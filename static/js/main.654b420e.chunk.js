(this.webpackJsonpchatappbudu=this.webpackJsonpchatappbudu||[]).push([[0],{46:function(e,t,c){},47:function(e,t,c){"use strict";c.r(t);var a=c(5),s=c.n(a),n=c(36),r=c.n(n),j=c(0),i=c(1),u=c(11),o=c(13),b=c(25),d=c(22),l=c(37),O=c(24),h=c(15),p=(Object(l.a)({apiKey:"AIzaSyCNe2WEpXW3DujpQL_D_151eVBSsSov1D4",authDomain:"chat-75f20.firebaseapp.com",projectId:"chat-75f20",storageBucket:"chat-75f20.appspot.com",messagingSenderId:"214814540477",appId:"1:214814540477:web:3c65552d8fd4ad2b982dd4"}),Object(d.b)()),x=Object(O.b)(),f=Object(h.g)(),m=c.p+"static/media/404error.2a9b2b2d.png",v=c(7),g=function(){return Object(v.jsx)("div",{className:"errorContainer",children:Object(v.jsxs)("div",{className:"errorContainer",children:[Object(v.jsx)("img",{src:m,alt:"error"}),Object(v.jsx)("p",{children:"Something went wrong"}),Object(v.jsx)("button",{children:Object(v.jsx)(b.b,{to:"/",children:"Go Back"})})]})})},N=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),c=t[0],s=t[1],n=Object(o.n)(),r=function(){var e=Object(i.a)(Object(j.a)().mark((function e(t){var c,a;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c=t.target[0].value,a=t.target[1].value,e.prev=3,e.next=6,Object(d.d)(p,c,a);case 6:n("/"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),s(!0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)(v.Fragment,{children:c?Object(v.jsx)(g,{}):Object(v.jsx)("div",{className:"formContainer",children:Object(v.jsxs)("div",{className:"formWrapper",children:[Object(v.jsx)("span",{className:"logo",children:"BuDu Chat"}),Object(v.jsx)("span",{className:"title",children:"Login"}),Object(v.jsxs)("form",{onSubmit:r,children:[Object(v.jsx)("input",{type:"email",placeholder:"email"}),Object(v.jsx)("input",{type:"password",placeholder:"password"}),Object(v.jsx)("button",{children:"Sign In"}),c&&Object(v.jsx)(g,{})]}),Object(v.jsxs)("p",{children:["Do you have an account? ",Object(v.jsx)(b.b,{to:"/register",children:"Register"})]})]})})})},y=c.p+"static/media/add-user.0653f26b.png",C=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),c=t[0],s=t[1],n=Object(o.n)(),r=function(){var e=Object(i.a)(Object(j.a)().mark((function e(t){var c,a,r,u,o,b,l;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c=t.target[0].value,a=t.target[1].value,r=t.target[2].value,u=t.target[3].files[0],e.prev=5,e.next=8,Object(d.a)(p,a,r);case 8:o=e.sent,b=Object(O.c)(x,c),(l=Object(O.d)(b,u)).on((function(e){s(!0)}),(function(){Object(O.a)(l.snapshot.ref).then(function(){var e=Object(i.a)(Object(j.a)().mark((function e(t){return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.f)(o.user,{displayName:c,photoURL:t});case 2:return e.next=4,Object(h.k)(Object(h.d)(f,"users",o.user.uid),{uid:o.user.uid,displayName:c,email:a,photoURL:t});case 4:return e.next=6,Object(h.k)(Object(h.d)(f,"userChats",o.user.uid),{});case 6:n("/");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),s(!0);case 17:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)(v.Fragment,{children:c?Object(v.jsx)(g,{}):Object(v.jsx)("div",{className:"formContainer",children:Object(v.jsxs)("div",{className:"formWrapper",children:[Object(v.jsx)("span",{className:"logo",children:"BuDu Chat"}),Object(v.jsx)("span",{className:"title",children:"Register"}),Object(v.jsxs)("form",{onSubmit:r,children:[Object(v.jsx)("input",{type:"text",placeholder:"display name"}),Object(v.jsx)("input",{type:"email",placeholder:"email"}),Object(v.jsx)("input",{type:"password",placeholder:"password"}),Object(v.jsx)("input",{style:{display:"none"},type:"file",id:"file"}),Object(v.jsxs)("label",{htmlFor:"file",children:[Object(v.jsx)("img",{src:y,alt:"avatarImage"}),Object(v.jsx)("span",{children:"Add an avatar"})]}),Object(v.jsx)("button",{children:"Sign Up"})]}),Object(v.jsxs)("p",{children:["Do you have an account? ",Object(v.jsx)(b.b,{to:"/login",children:"Login"})]})]})})})},I=(c.p,Object(a.createContext)()),w=function(e){var t=e.children,c=Object(a.useState)({}),s=Object(u.a)(c,2),n=s[0],r=s[1];return Object(a.useEffect)((function(){var e=Object(d.c)(p,(function(e){r(e)}));return function(){e()}}),[]),Object(v.jsx)(I.Provider,{value:{currentUser:n},children:t})},k=function(){var e=Object(a.useContext)(I).currentUser;return Object(v.jsxs)("div",{className:"navbar",children:[Object(v.jsx)("span",{className:"logo",children:"Logo Chat"}),Object(v.jsxs)("div",{className:"user",children:[Object(v.jsx)("img",{src:e.photoURL,alt:"userPhoto"}),Object(v.jsx)("span",{children:e.displayName}),Object(v.jsx)("button",{onClick:function(){return Object(d.e)(p)},children:"logout"})]})]})},U=c(4),S=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],n=Object(a.useState)(null),r=Object(u.a)(n,2),o=r[0],b=r[1],d=Object(a.useState)(!1),l=Object(u.a)(d,2),O=l[0],p=l[1],x=Object(a.useContext)(I).currentUser,m=function(){var e=Object(i.a)(Object(j.a)().mark((function e(){var t;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(h.i)(Object(h.c)(f,"users"),Object(h.m)("displayName","==",c)),e.prev=1,e.next=4,Object(h.f)(t);case 4:e.sent.forEach((function(e){b(e.data())})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),p(!0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(Object(j.a)().mark((function e(){var t,c,a;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=x.uid>o.uid?x.uid+o.uid:o.uid+x.uid,e.prev=1,e.next=4,Object(h.e)(Object(h.d)(f,"chats",t));case 4:if(e.sent.exists()){e.next=12;break}return e.next=8,Object(h.k)(Object(h.d)(f,"chats",t),{messages:[]});case 8:return e.next=10,Object(h.l)(Object(h.d)(f,"userChats",x.uid),(c={},Object(U.a)(c,t+".userInfo",{uid:o.uid,displayName:o.displayName,photoURL:o.photoURL}),Object(U.a)(c,t+".date",Object(h.j)()),c));case 10:return e.next=12,Object(h.l)(Object(h.d)(f,"userChats",o.uid),(a={},Object(U.a)(a,t+".userInfo",{uid:x.uid,displayName:x.displayName,photoURL:x.photoURL}),Object(U.a)(a,t+".date",Object(h.j)()),a));case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(1);case 16:b(null),s("");case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"search",children:[Object(v.jsx)("div",{className:"searchForm",children:Object(v.jsx)("input",{type:"text",placeholder:"Find a user...",onKeyDown:function(e){"Enter"===e.code&&m()},onChange:function(e){return s(e.target.value)},value:c})}),O&&Object(v.jsx)("span",{children:"User Not Found"}),o&&Object(v.jsxs)("div",{className:"userChat",onClick:g,children:[Object(v.jsx)("img",{src:o.photoURL,alt:"userPhoto"}),Object(v.jsx)("div",{className:"userChatInfo",children:Object(v.jsx)("span",{children:o.displayName})})]})]})},R=Object(a.createContext)(),L=function(e){var t=e.children,c=Object(a.useContext)(I).currentUser,s=Object(a.useReducer)((function(e,t){if("CHANGE_USER"===t.type)return{user:t.payload,chatId:c.uid>t.payload.uid?c.uid+t.payload.uid:t.payload.uid+c.uid}}),{chatId:"null",user:{}}),n=Object(u.a)(s,2),r=n[0],j=n[1];return Object(v.jsx)(R.Provider,{value:{data:r,dispatch:j},children:t})},E=function(){var e,t=Object(a.useState)([]),c=Object(u.a)(t,2),s=c[0],n=c[1],r=Object(a.useContext)(I).currentUser,j=Object(a.useContext)(R).dispatch;Object(a.useEffect)((function(){r.uid&&function(){var e=Object(h.h)(Object(h.d)(f,"userChats",r.uid),(function(e){n(e.data())}))}()}),[r.uid]);return Object(v.jsx)("div",{className:"chats",children:null===(e=Object.entries(s))||void 0===e?void 0:e.sort((function(e,t){return t[1].date-e[1].date})).map((function(e){var t;return Object(v.jsxs)("div",{className:"userChat",onClick:function(){return t=e[1].userInfo,void j({type:"CHANGE_USER",payload:t});var t},children:[Object(v.jsx)("img",{src:e[1].userInfo.photoURL,alt:"userPhoto"}),Object(v.jsxs)("div",{className:"userChatInfo",children:[Object(v.jsx)("span",{children:e[1].userInfo.displayName}),Object(v.jsx)("p",{children:null===(t=e[1].lastMessage)||void 0===t?void 0:t.text})]})]},e[0])}))})},D=function(){return Object(v.jsxs)("div",{className:"sidebar",children:[Object(v.jsx)(k,{}),Object(v.jsx)(S,{}),Object(v.jsx)(E,{})]})},F=c.p+"static/media/video-camera-svgrepo-com.e2b4f992.svg",P=c.p+"static/media/user-add-svgrepo-com.94fcd152.svg",B=c.p+"static/media/more-svgrepo-com.6600884b.svg",A=function(e){var t=e.messages,c=Object(a.useContext)(I).currentUser,s=Object(a.useContext)(R).data,n=Object(a.useRef)();return Object(a.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[t]),Object(v.jsxs)("div",{className:"message $".concat(t.senderId===c.uid&&"owner"),children:[Object(v.jsxs)("div",{className:"messageInfo",children:[Object(v.jsx)("img",{src:t.senderId===c.uid?c.photoURL:s.user.photoURL,alt:"UserPhoto"}),Object(v.jsx)("span",{children:"just now"})]}),Object(v.jsxs)("div",{className:"messageContent",children:[Object(v.jsx)("p",{children:t.text}),t.img&&Object(v.jsx)("img",{src:t.img,alt:"UserPhoto"})]})]})},M=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),c=t[0],s=t[1],n=Object(a.useContext)(R).data;return Object(a.useEffect)((function(){var e=Object(h.h)(Object(h.d)(f,"chats",n.chatId),(function(e){e.exists()&&s(e.data().messages)}));return function(){e()}}),[n.chatId]),Object(v.jsx)("div",{className:"messages",children:c.map((function(e){return Object(v.jsx)(A,{messages:e},e.id)}))})},W=c(49),_=c.p+"static/media/attach-svgrepo-com.563a6fea.svg",G=c.p+"static/media/image-add-fill-svgrepo-com.e311e3a8.svg",H=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],n=Object(a.useState)(null),r=Object(u.a)(n,2),o=r[0],b=r[1],d=Object(a.useContext)(I).currentUser,l=Object(a.useContext)(R).data,p=function(){var e=Object(i.a)(Object(j.a)().mark((function e(){var t,a,n,r;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=6;break}n=Object(O.c)(x,Object(W.a)()),(r=Object(O.d)(n,o)).on((function(e){}),(function(){Object(O.a)(r.snapshot.ref).then(function(){var e=Object(i.a)(Object(j.a)().mark((function e(t){return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.l)(Object(h.d)(f,"chats",l.chatId),{messages:Object(h.b)({id:Object(W.a)(),text:c,senderId:d.uid,date:h.a.now(),img:t})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),e.next=8;break;case 6:return e.next=8,Object(h.l)(Object(h.d)(f,"chats",l.chatId),{messages:Object(h.b)({id:Object(W.a)(),text:c,senderId:d.uid,date:h.a.now()})});case 8:return e.next=10,Object(h.l)(Object(h.d)(f,"userChats",d.uid),(t={},Object(U.a)(t,l.chatId+".lastMessage",{text:c}),Object(U.a)(t,l.chatId+".date",Object(h.j)()),t));case 10:return e.next=12,Object(h.l)(Object(h.d)(f,"userChats",l.user.uid),(a={},Object(U.a)(a,l.chatId+".lastMessage",{text:c}),Object(U.a)(a,l.chatId+".date",Object(h.j)()),a));case 12:s(""),b(null);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"input",children:[Object(v.jsx)("input",{type:"text",placeholder:"Type something...",onChange:function(e){return s(e.target.value)},value:c}),Object(v.jsxs)("div",{className:"send",children:[Object(v.jsx)("img",{src:_,alt:"attach"}),Object(v.jsx)("input",{type:"file",name:"file",id:"file",style:{display:"none"},onChange:function(e){return b(e.target.files[0])}}),Object(v.jsx)("label",{htmlFor:"file",children:Object(v.jsx)("img",{src:G,alt:"images"})}),Object(v.jsx)("button",{onClick:p,children:"Send"})]})]})},J=function(){var e,t=Object(a.useContext)(R).data;return Object(v.jsxs)("div",{className:"chat",children:[Object(v.jsxs)("div",{className:"chatInfo",children:[Object(v.jsx)("span",{children:null===(e=t.user)||void 0===e?void 0:e.displayName}),Object(v.jsxs)("div",{className:"chatIcons",children:[Object(v.jsx)("img",{src:F,alt:"camera"}),Object(v.jsx)("img",{src:P,alt:"user"}),Object(v.jsx)("img",{src:B,alt:"more"})]})]}),Object(v.jsx)(M,{}),Object(v.jsx)(H,{})]})},K=function(){return Object(v.jsx)("div",{className:"home",children:Object(v.jsxs)("div",{className:"container",children:[Object(v.jsx)(D,{}),Object(v.jsx)(J,{})]})})};c(46);var V=function(){var e=Object(a.useContext)(I).currentUser,t=function(t){var c=t.children;return e?c:Object(v.jsx)(o.a,{to:"/login"})};return Object(v.jsx)(b.a,{children:Object(v.jsx)(o.d,{children:Object(v.jsxs)(o.b,{path:"/",children:[Object(v.jsx)(o.b,{index:!0,element:Object(v.jsx)(t,{children:Object(v.jsx)(K,{})})}),Object(v.jsx)(o.b,{path:"login",element:Object(v.jsx)(N,{})}),Object(v.jsx)(o.b,{path:"register",element:Object(v.jsx)(C,{})}),Object(v.jsx)(o.b,{path:"error",element:Object(v.jsx)(g,{})})]})})})};r.a.createRoot(document.getElementById("root")).render(Object(v.jsx)(w,{children:Object(v.jsx)(L,{children:Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(V,{})})})}))}},[[47,1,2]]]);
//# sourceMappingURL=main.654b420e.chunk.js.map